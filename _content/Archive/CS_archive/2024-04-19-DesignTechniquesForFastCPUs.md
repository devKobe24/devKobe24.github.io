---
title: "💾 [CS] 빠른 CPU를 위한 설계 기법"
tags:
    - CS
date: "2024-04-19"
thumbnail: "/assets/img/thumbnail/cs.jpeg"
---

# 빠른 CPU를 위한 설계 기법.

## 클럭
조금이라도 더 빠른 CPU를 만들려면 어떻게 CPU를 설계해야 할까요?

이전에 학습한 내용을 상기해봅시다.
1. 컴퓨터 부품들은 '클럭 신호'에 맞춰 일사분란하게 움직인다.
2. CPU는 '명령어 사이클'이라는 정해진 흐름에 맞춰 명령어들을 실행한다.

클럭 신호가 빠르게 반복되면 CPU를 비롯한 컴퓨터 부품들은 그만큼 빠른 박자에 맞춰 움직일 것 입니다.
- 즉, 클럭 속도가 높아지면 CPU는 명령어 사이클을 더 빠르게 반복할 것이고, 다른 부품들도 그에 발맞춰 더 빠르게 작동할 것입니다.

실제로 클럭 속도가 높은 CPU는 일반적으로 성능이 좋습니다.
- 그래서 클럭 속도는 CPU 속도 단위로 간주되기도 합니다.

- **클럭 속도:** 헤르츠(Hz) 단위로 측정합니다. 이는 1초에 클럭이 몇 번 반복되는지를 나타냅니다.
    - 가령 클럭이 '똑-딱-'하고 1초에 한 번 반복되면 CPU 클럭 속도는 1Hz인 것이고, 클럭이 1초에 100번 반복되면 CPU 클럭 속도는 100Hz인 셈입니다.

<img src = "https://github.com/devKobe24/images/blob/main/CPU%E1%84%8F%E1%85%B3%E1%86%AF%E1%84%85%E1%85%A5%E1%86%A8%E1%84%89%E1%85%A9%E1%86%A8%E1%84%83%E1%85%A9.png?raw=true">

실제 CPU 클럭 속도는 위 사진 속 CPU를 보면 알 수 있습니다.
- 위 사진 속 CPU를 보면 기본 속도(Base)는 2.5GHz, 최대 속도(Max)는 4.9GHz라는 것을 알 수 있습니다.
    - 이는 1초에 클럭이 기본적으로 25억(2.5 x 10⁹)번 반복된다는 것을 나타냅니다.
> 참고: 1GHz는 1,000,000,000(10⁹)Hz입니다.

> **"클럭 속도는 일정하지 않다."**
> '클럭'이라는 단어만 보고 시계를 떠올려 클럭 속도가 매번 일정하게 유지된다고 생각할 수도 있지만, 실제로는 그렇지 않습니다.
> 
> CPU 사진을 다시 보면 기본 클럭 속도(Base)와 최대 속도(Max)로 나위어 있습니다.
> 이처럼 CPU는 계속 일정한 클럭 속도를 유지하기보다는 고성능을 요하는 순간에는 순간적으로 쿨럭 속도를 높이고, 그렇지 않을 때는 유연하게 쿨럭 속도를 낮추기도 합니다.
> 최대 클럭 속도를 강제로 더 끌어올릴 수도 있는데, 이런 기법을 **오버클럭킹(overclocking)** 이라고 합니다.

클럭 속도를 무지막지하게 높이면 CPU는 무작정 빨라지지 않습니다.
- 그래픽이 많이 요구되는 게임이나 영상 편집과 같이 CPU에 무리가 가는 작업을 장시간 하면 컴퓨터가 뜨겁게 달아오르는 것을 경험해 본 적이 있을 겁니다.
    - 클럭 속도를 무작정 높이면 이러한 발열 문제가 더 심각해집니다.
        - 이처럼 클럭 속도를 높이는 것은 분명 CPU를 빠르게 만들지만, 클럭 속도만으로 CPU의 성늘을 올리는 것에는 한계가 있습니다.

## 코어와 멀티 코어
클럭 속도를 높이는 방법 외에 CPU의 성능을 높이는 방법에는 대표적으로 CPU의 코어와 스레드 수를 늘리는 방법이 있습니다.

먼저 코어를 늘리는 방법을 알아봅시다.

코어를 이해하려면 현대적인 관점에서 CPU라는 용어를 재해석해야 합니다.

앞서 CPU를 '명령어를 실행하는 부품'이라고 소개했습니다.
많은 전공 서적들의 전통적인 관점에서 '명령어를 실행하는 부품'은 원칙적으로 하나만 존재했습니다.
하지만 오늘날 CPU는 많은 기술적 발전을 거듭하였고, 그 결과 CPU 내부에는 '명령어를 실행하는 부품'을 얼마든지 만들 수 있게 되었습니다.

우리가 지금까지 CPU의 정의로 알고 있었던 '명령어를 실행하는 부품'은 오늘날 **코어(core)** 라는 용어로 사용됩니다.
- 다시 말해, 오늘날의 CPU는 단순히 '명령어를 실행하는 부품'에서 '명령어를 실행하는 부품을 여러 개 포함하는 부품'으로 명칭의 범위가 확장 되었습니다.
    - 예를 들어 8코어(Core) CPU는 '명령어를 실행하는 부품'을 여덟 개 포함하고 있다고 보면 됩니다.

<img src = "https://github.com/devKobe24/images/blob/main/%E1%84%8B%E1%85%A9%E1%84%82%E1%85%B3%E1%86%AF%E1%84%82%E1%85%A1%E1%86%AF%E1%84%8B%E1%85%B4CPU%E1%84%8B%E1%85%AA%E1%84%8C%E1%85%A5%E1%86%AB%E1%84%90%E1%85%A9%E1%86%BC%E1%84%8C%E1%85%A5%E1%86%A8%E1%84%8B%E1%85%B5%E1%86%ABCPU.png?raw=true">

코어를 여러 개 포함하고 있는 CPU를 **멀티코어(multi-core) CPU** 또는 **멀티코어 프로세서**라고 부릅니다.
- 이는 CPU 내에 명령어를 처리하는 일꾼이 여러 명 있는 것과 같습니다.
- 당연히 멀티코어의 처리 속도는 단일코어보다 더 빠릅니다.
    - 다령 클럭 속도가 2.4GHz인 단일 코어 CPU와 클럭 속도가 1.9GHz인 멀티코어 CPU를 비교하면 일반적으로 후자의 성능이 더 좋습니다.

CPU 종류는 CPU 안에 코어가 몇 개 포함되어 있는지에 따라 아래 표와 같이 싱글코어, 듀얼코어, 트리플코어 등으로 나뉩니다.

<img src = "https://github.com/devKobe24/images/blob/main/%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%89%E1%85%A6%E1%84%89%E1%85%A5%E1%84%86%E1%85%A7%E1%86%BC%E1%84%8E%E1%85%B5%E1%86%BC.png?raw=true">

코어를 늘릴수록 연산 처리 속도도 빨라질까요?
- CPU의 연산 속도가 꼭 코어 수에 비례하여 증가하지는 않습니다.
    - 코어마다 처리할 연산이 적절히 분배되지 않는다면 코어 수에 비례하여 연산 속도가 증가하지 않습니다.
    - 또한 처리하고자 하는 작업량보다 코어 수가 지나치게 많아도 성능에는 크게 영향이 없습니다.
        - 중요한 것은 코어마다 처리할 명령어들을 얼마나 적절하게 분배하느냐이고 그에 따라서 연산 속도는 크게 달라집니다.

## 스레드와 멀티스레드
- **스레드(thread):** 사전적 의미는 '실행 흐름의 단위'입니다.
    - 하지만 이 정의를 활자 그대로 받아들이지 말고 더욱 엄밀하게 이해해야 합니다.
    - CPU에서 사용되는 스레드와 프로그래밍에서 사용되는 스레드는 용례가 다르기 때문입니다.

스레드에는 CPU에서 사용되는 **하드웨어적 스레드**가 있고, 프로그램에서 사용되는 **소프트웨어적 스레드**가 있습니다.

### 하드웨어적 스레드
스레드를 하드웨어적으로 정의하면 '하나의 코어가 동시에 처리하는 명령어 단위'를 의미합니다.
CPU에서 사용하는 스레드라는 용어는 보통 CPU 입장에서 정의된 하드웨어적 스레드를 의미합니다.

하나의 코어로 여러 명령어를 동시에 처리하는 CPU를 **멀티스레드(multithread) 프로세서** 또는 **멀티스레드 CPU**라고 합니다.

- **하이퍼스레딩(hyper-threading):** 인텔의 멀티스레드 기술을 의미합니다.
    - 인텔이 자신들의 멀티스레드 기술에 하이퍼스레딩이라는 명칭을 부여한 것입니다.

### 소프트웨어적 스레드
소프트웨어적으로 정의된 스레드는 '하나의 프로그램에서 독립적으로 실행되는 단위'를 의미합니다.
- 프로그래밍 언어나 운영체제를 학습할 때 접하는 스레드는 보통 이렇게 소프트웨어적으로 정의된 스레드를 의미합니다.

하나의 프로그램은 실행되는 과정에서 한 부분만 실행될 수도 있지만, 프로그램의 여러 부분이 동시에 실행될 수도 있습니다.

<img src = "https://github.com/devKobe24/images/blob/main/%E1%84%89%E1%85%B5%E1%86%BC%E1%84%80%E1%85%B3%E1%86%AF%E1%84%89%E1%85%B3%E1%84%85%E1%85%A6%E1%84%83%E1%85%B3%E1%84%8B%E1%85%AA%E1%84%86%E1%85%A5%E1%86%AF%E1%84%90%E1%85%B5%E1%84%89%E1%85%B3%E1%84%85%E1%85%A6%E1%84%83%E1%85%B3.png?raw=true">

가령 워드 프로세서 프로그램을 개발한다고 가정해봅시다.
그리고 아래의 기능이 동시에 수행되길 원한다고 해 봅시다.
1. 사용자로부터 입력받은 내용을 화면에 보여 주는 기능
2. 사용자가 입력한 내용이 맞춤법에 맞는지 검사하는 기능
3. 사용자가 입력한 내용을 수시로 저장하는 기능

이 기능들을 작동시키는 코드를 각각의 스레드로 만들면 동시에 실행할 수 있습니다.

<img src = "https://github.com/devKobe24/images/blob/main/%E1%84%8B%E1%85%AF%E1%84%83%E1%85%B3%E1%84%89%E1%85%B3%E1%84%85%E1%85%A6%E1%84%83%E1%85%B3%E1%84%8B%E1%85%A8%E1%84%89%E1%85%B5%E1%84%80%E1%85%B3%E1%84%85%E1%85%B5%E1%86%B7.png?raw=true">

정리하면, 스레드의 하드웨어적 정의는 '하나의 코어가 동시에 처리하는 명령어의 단위'를 의미하고, 소프트웨어적 정의는 '하나의 프로그램에서 독립적으로 실행되는 단위'를 의미합니다.

한 번에 하나씩 명령어를 처리하는 1코어 1스레드 CPU도 소프트웨어적 스레드를 수십 개 실행할 수 있습니다.
1 코어 1 스레드 CPU로도 프로그램의 여러 부분을 동시에 실행할 수 있습니다.

만약 스레드의 사전적 정의(실행 흐름의 단위)만을 암기한다면 '1코어 1스레드 CPU가 여러 스레드로 만들어진 프로그램을 실행할 수 있다'라는 말이 어려울 겁니다.
- 이런 이유로 하드웨어적 스레드와 소프트웨어적 스레드는 구분하여 기억하는 것이 좋습니다.

### 멀티스레드 프로세서
하나의 코어로 여러 명령어를 동시에 처리하는 기술인 하드웨어적 스레드를 **"멀티스레드 프로세서"** 라고 합니다.

멀티스레드 프로세서는 하나의 코어로 여러 명령어를 동시에 처리하는 CPU라고 했었습니다. 어떨게 이런 일이 가능할까요?
- **"멀티스레드 프로세서"** 를 실제로 설계하는 일은 매우 복잡하지만, 가장 큰 핵심은 레지스터입니다.
    - 하나의 코어로 여러 명령어를 동시에 처리하도록 만들려면 프로그램 카운터, 스택 포인터, 메모리 버퍼 레지스터, 메모리 주소 레지스터와 같이 하나의 명령어를 처리하기 위해 꼭 필요한 레지스터를 여러개 가지고 있으면 됩니다.
        - 가열 프로그램 카운터가 두 개 있다면 '메모리에서 가져올 명령어 주소'를 두 개 지정할 수 있을 것이고, 스택 포인터가 두 개 있다면 두 개의 스택을 관리할 수 있을것 입니다.

아래의 그림을 봅시다.

하나의 명령어를 실행하기 위해 꼭 필요한 레지스터들을 편의상 '레지스터 세트'라고 표기했습니다.
- 레지스터 세트가 한 개인 CPU는 한 개의 명령어를 처리하기 위한 정보들을 기억할 뿐이지만, 레지스터 세트가 두 개인 CPU는 두 개의 명령어를 처리하기 위한 정보들을 기억할 수 있습니다.
    - 여기서 ALU와 제어장치가 두 개의 레지스터 세트에 저장된 명령어를 해석하고 실행하면 하나의 코어에서 두 개의 명령어가 동시에 실행됩니다.

<img src = "https://github.com/devKobe24/images/blob/main/2%E1%84%8F%E1%85%A9%E1%84%8B%E1%85%A54%E1%84%89%E1%85%B3%E1%84%85%E1%85%A6%E1%84%83%E1%85%B3CPU.png?raw=true">

하드웨어 스레드를 이용해 하나의 코어로도 여러 명령어를 동시에 처리할 수 있습니다.
- 그러나 메모리 속 프로그램 입장에서 봤을 때 하드웨어 스레드는 마치 '한 번에 하나의 명령어를 처리하는 CPU'나 다름없습니다.
    - 가령 2코어 4스레드 CPU는 한 번에 네 개의 명령어를 처리할 수 있는데, 프로그램 입장에서 봤을 땐 한 번에 하나의 명령어를 처리하는 CPU가 네 개 있는 것처럼 보입니다.
        - 그래서 하드웨어 스레드를 **논리 프로세서(logical processor)** 라고 부르기도 합니다.

<img src = "https://github.com/devKobe24/images/blob/main/%E1%84%82%E1%85%A9%E1%86%AB%E1%84%85%E1%85%B5%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%89%E1%85%A6%E1%84%89%E1%85%A5.png?raw=true">

**"코어"** 는 명령어를 실행할 수 있는 '하드웨어 부품'이고, **"스레드"** 는 '명령어를 실행하는 단위'입니다.
**"멀티코어 프로세서"** 는 명령어를 실행할 수 있는 하드웨어 부품이 CPU 안에 두 개 이상 있는 CPU를 의미하고, **"멀티스레드 프로세서"** 는 하나의 코어로 여러 개의 명령어를 동시에 실행할 수 있는 CPU를 의미합니다.

## 키워드로 정리하는 핵심 포인트
- **클럭** 속도가 높은 CPU는 빠르게 작동합니다.
- **코어** 란 CPU 내에서 명령어를 실행하는 부품입니다.
- **멀티코어** 프로세서란 여러 개의 코어를 포함하는 CPU를 말합니다.
- **스레드**에는 하드웨어적 스레드와 소프트웨어적 스레드가 있습니다.
- **멀티스레드** 프로세서란 하나의 코어로 여러 개의 명령어를 동시에 실행할 수 있는 CPU를 말합니다.
