---
title: πƒ[Spring] μμ΅΄μ„± μ£Όμ…(Dependency Injection)μ„ ν†µν• λμ¨ν• κ²°ν•©(Loose Coupling) μ μ§€.
tags:
    - Spring
    - Framework
date: "2024-09-02"
thumbnail: "/assets/img/thumbnail/spring.jpeg"
---

# πƒ[Spring] μμ΅΄μ„± μ£Όμ…(Dependency Injection)μ„ ν†µν• λμ¨ν• κ²°ν•©(Loose Coupling) μ μ§€.
- μ•„λμ μ½”λ“μ—μ„ **`@Autowired`** λ΅ **`MemberService`** ν΄λμ¤μ μƒμ„±μμ— **`MemberRepository`** μΈν„°νμ΄μ¤λ¥Ό μ£Όμ…λ°›λ” μ΄μ λ” **μμ΅΄μ„± μ£Όμ…(Dependency Injection)** μ„ ν†µν•΄ **λμ¨ν• κ²°ν•©(Loose Coupling)** μ„ μ μ§€ν•κΈ° μ„ν•©μ…λ‹λ‹¤.
    - μ΄λ” κ°μ²΄μ§€ν–¥ μ„¤κ³„μ—μ„ λ§¤μ° μ¤‘μ”ν• μ›μΉ™ μ¤‘ ν•λ‚λ΅, ν΄λμ¤ κ°„μ κ²°ν•©λ„λ¥Ό λ‚®μ¶° μ½”λ“μ μ μ—°μ„±κ³Ό ν™•μ¥μ„±μ„ λ†’μ΄λ” λ° κΈ°μ—¬ν•©λ‹λ‹¤.

## 1οΈβƒ£ μ „μ²΄ μ½”λ“.

```java
// MemberRepository
import com.devkobe.hello_spring.domain.Member;
import java.util.List;
import java.util.Optional;


public interface MemberRepository {
	Member save(Member member);
	Optional<Member> findById(Long id);
	Optional<Member> findByName(String name);
	List<Member> findAll();
}

// MemoryMemberRepository
import com.devkobe.hello_spring.domain.Member;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;
import java.util.Optional;
import org.springframework.stereotype.Repository;

@Repository
public class MemoryMemberRepository implements MemberRepository {

	private static Map<Long, Member> store = new HashMap<>();
	private static long sequence = 0L;

	@Override
	public Member save(Member member) {
		member.setId(++sequence);
		store.put(member.getId(), member);
		return member;
	}

	@Override
	public Optional<Member> findById(Long id) {
		return Optional.ofNullable(store.get(id));
	}

	@Override
	public Optional<Member> findByName(String name) {
		return store.values().stream()
				.filter(member -> member.getName().equals(name))
				.findAny();
	}

	@Override
	public List<Member> findAll() {
		return new ArrayList<>(store.values());
	}

	public void clearStore() {
		store.clear();
	}
}

// MemberService
import com.devkobe.hello_spring.domain.Member;
import com.devkobe.hello_spring.repository.MemberRepository;
import com.devkobe.hello_spring.repository.MemoryMemberRepository;
import java.util.List;
import java.util.Optional;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

@Service
public class MemberService {
	private final MemberRepository memberRepository;

	@Autowired
	public MemberService(MemberRepository memberRepository) {
		this.memberRepository = memberRepository;
	}

	/*
	 * νμ› κ°€μ…
	 */
	public Long join(Member member) {

		validateDuplicateMember(member); // μ¤‘λ³µ νμ› κ²€μ¦
		memberRepository.save(member);
		return member.getId();
	}

	private void validateDuplicateMember(Member member) {
		memberRepository.findByName(member.getName())
				.ifPresent(m -> {
					throw new IllegalStateException("μ΄λ―Έ μ΅΄μ¬ν•λ” νμ›μ…λ‹λ‹¤.");
				});
	}

	/*
	 * μ „μ²΄ νμ› μ΅°ν
	 */
	public List<Member> findMembers() {
		return memberRepository.findAll();
	}

	public Optional<Member> findOne(Long memberId) {
		return memberRepository.findById(memberId);
	}
}
```

## 2οΈβƒ£ κµ¬μ²΄μ μΈ μ΄μ .
- **1. μΈν„°νμ΄μ¤λ¥Ό ν†µν• μ μ—°μ„± ν™•λ³΄.**
    - **`MemberRepository`** λ” μΈν„°νμ΄μ¤λ΅, **`MemoryMemberRepository`** μ™€ κ°™μ€ κµ¬ν„μ²΄λ“¤μ΄ μ΄ μΈν„°νμ΄μ¤λ¥Ό κµ¬ν„ν•©λ‹λ‹¤.
        - μΈν„°νμ΄μ¤λ¥Ό ν†µν•΄ **`MemberService`** λ” νΉμ • κµ¬ν„μ²΄μ— μμ΅΄ν•μ§€ μ•μΌλ©°, **`MemberRepository`** μΈν„°νμ΄μ¤μ— μμ΅΄ν•κ² λ©λ‹λ‹¤.
            - μ΄λ” **`MemberService`** κ°€ **`MemoryMemberRepository`** λ‚ λ‹¤λ¥Έ **`MemberRepository`** κµ¬ν„μ²΄(**`JdbcMemberRepository`**, **`JpaMemberRepository`** λ“±)μ— μ‰½κ² κµμ²΄λ  μ μμμ„ μλ―Έν•©λ‹λ‹¤.
                - μλ¥Ό λ“¤μ–΄, λ‚μ¤‘μ— λ©”λ¨λ¦¬κ°€ μ•„λ‹ λ°μ΄ν„°λ² μ΄μ¤μ— νμ› μ •λ³΄λ¥Ό μ €μ¥ν•λ” λ°©μ‹μΌλ΅ μ „ν™ν•κ³  μ‹¶λ‹¤λ©΄, **`MemoryMemberRepository`** λ€μ‹  μƒλ΅μ΄ κµ¬ν„μ²΄λ¥Ό μ£Όμ…ν•λ©΄ λ©λ‹λ‹¤.
- **2. λμ¨ν• κ²°ν•©.**
    - **`MemberService`** λ” **`MemberRepository`** μΈν„°νμ΄μ¤μ—λ§ μμ΅΄ν•κΈ° λ•λ¬Έμ—, μ–΄λ–¤ κµ¬ν„μ²΄κ°€ μ‹¤μ λ΅ μ‚¬μ©λ μ§€λ” μ¤ν”„λ§ μ»¨ν…μ΄λ„κ°€ κ²°μ •ν•©λ‹λ‹¤.
        - μ΄λ ‡κ² ν•λ©΄ **`MemberService`** λ” κµ¬ν„μ²΄κ°€ λ¬΄μ—‡μΈμ§€ μ• ν•„μ”κ°€ μ—†μΌλ―€λ΅, κµ¬ν„μ²΄κ°€ λ³€κ²½λλ”λΌλ„ **`MemberService`** λ¥Ό μμ •ν•  ν•„μ”κ°€ μ—†μµλ‹λ‹¤.
    - μ΄ λ°©μ‹μ€ μ μ§€λ³΄μμ„±μ„ ν¬κ² ν–¥μƒμ‹ν‚µλ‹λ‹¤.
        - μƒλ΅μ΄ μ €μ¥μ† λ°©μ‹μ΄ λ„μ…λλ”λΌλ„, κΈ°μ΅΄ λΉ„μ¦λ‹μ¤ λ΅μ§μ— μν–¥μ„ μ£Όμ§€ μ•κ³  μƒλ΅μ΄ κΈ°λ¥μ„ μ¶”κ°€ν•  μ μμµλ‹λ‹¤.
- **3. μ¤ν”„λ§μ μμ΅΄μ„± μ£Όμ… λ©”μ»¤λ‹μ¦ ν™μ©.**
    - μ¤ν”„λ§μ€ μλ™μΌλ΅ **`@Autowired`** λ¥Ό μ‚¬μ©ν•μ—¬ μ μ ν• **`MemberRepository`** κµ¬ν„μ²΄λ¥Ό μ°Ύμ•„ μ£Όμ…ν•©λ‹λ‹¤.
        - **`MemoryMemberRepository`** ν΄λμ¤μ— **`@Repository`** μ• λ…Έν…μ΄μ…μ΄ λ¶™μ–΄ μκΈ° λ•λ¬Έμ—, μ¤ν”„λ§ μ»¨ν…μ΄λ„λ” μ΄ ν΄λμ¤λ¥Ό **`MemberRepository`** νƒ€μ…μ λΉμΌλ΅ μΈμ‹ν•κ³  κ΄€λ¦¬ν•κ² λ©λ‹λ‹¤.
    - μ¤ν”„λ§μ€ **`MemberRepository`** μΈν„°νμ΄μ¤ νƒ€μ…μ λΉμ„ μ£Όμ…ν•΄μ•Ό ν•λ” κ²½μ°, ν•΄λ‹Ή μΈν„°νμ΄μ¤λ¥Ό κµ¬ν„ν• ν΄λμ¤ μ¤‘ ν•λ‚λ¥Ό μ„ νƒν•΄ μ£Όμ…ν•©λ‹λ‹¤.
        - μ΄ μμ μ—μ„λ” **`MemoryMemberRepository`** κ°€ μ£Όμ…λ©λ‹λ‹¤.

## 3οΈβƒ£ κ²°λ΅ .
- μ΄λ¬ν• μ„¤κ³„λ” μ½”λ“μ μ μ—°μ„±κ³Ό ν…μ¤νΈ μ©μ΄μ„±μ„ ν¬κ² ν–¥μƒμ‹ν‚µλ‹λ‹¤.
    - μΈν„°νμ΄μ¤λ¥Ό μ‚¬μ©ν•¨μΌλ΅μ¨, **`MemberService`** λ” νΉμ • κµ¬ν„μ²΄μ— κµ¬μ• λ°›μ§€ μ•κ³  λ‹¤μ–‘ν• ν™κ²½μ—μ„ μ¬μ‚¬μ©λ  μ μμµλ‹λ‹¤.
        - λν•, μ΄λ” μ¤ν”„λ§μ DI μ›μΉ™μ— λ”°λΌ, μ»΄ν¬λ„νΈ κ°„μ κ²°ν•©λ„λ¥Ό λ‚®μ¶”κ³ , μ• ν”λ¦¬μΌ€μ΄μ…μ΄ λ³€ν™”μ— μ λ€μ‘ν•  μ μλ„λ΅ μ„¤κ³„ν•λ” λ°©λ²•μ…λ‹λ‹¤.
