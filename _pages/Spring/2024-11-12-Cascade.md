---
title: ğŸƒ[Spring] JPAì—ì„œì˜ Cascade ì˜µì…˜
tags:
    - Spring
    - Framework
date: "2024-11-12"
thumbnail: "/assets/img/thumbnail/spring.jpeg"
---

# ğŸƒ[Spring] JPAì—ì„œì˜ Cascade ì˜µì…˜.
- JPAì—ì„œ **Cascade ì˜µì…˜**ì€ ì—”í‹°í‹° ê°„ì˜ ì—°ê´€ê´€ê³„ì—ì„œ íŠ¹ì • ì—”í‹°í‹°ì— ìˆ˜í–‰ëœ ì‘ì—…(ì €ì¥, ì‚­ì œ ë“±)ì´ **ì—°ê´€ëœ ë‹¤ë¥¸ ì—”í‹°í‹°ì— í•¨ê»˜ ì ìš©ë˜ë„ë¡** ì„¤ì •í•˜ëŠ” ì˜µì…˜ì…ë‹ˆë‹¤.
    - ì¦‰, ë¶€ëª¨ ì—”í‹°í‹°ê°€ íŠ¹ì • ì‘ì—…ì„ ìˆ˜í–‰í•  ë•Œ **ìì‹ ì—”í‹°í‹°ë„ ë™ì¼í•œ ì‘ì—…ì´ ìë™ìœ¼ë¡œ ì „íŒŒ**ë˜ê²Œ ë§Œë“­ë‹ˆë‹¤.

## 1ï¸âƒ£ Cascade ì˜µì…˜ì˜ ì¢…ë¥˜.
- Cascade ì˜µì…˜ì—ëŠ” ì—¬ëŸ¬ ê°€ì§€ ì¢…ë¥˜ê°€ ìˆìœ¼ë©°, ê°ê°ì˜ ì˜µì…˜ì€ ë‹¤ë¥¸ ì‘ì—…ì„ ì „íŒŒí•©ë‹ˆë‹¤.

### 1ï¸âƒ£ CascadeType.PERSIST
- ë¶€ëª¨ ì—”í‹°í‹°ê°€ **ì €ì¥ë  ë•Œ**, ì—°ê´€ëœ ìì‹ ì—”í‹°í‹°ë„ í•¨ê»˜ ì €ì¥ë©ë‹ˆë‹¤.
    - EntityManager.persist() í˜¸ì¶œ ì‹œ ìì‹ ì—”í‹°í‹°ë„ ìë™ìœ¼ë¡œ persistë©ë‹ˆë‹¤.

### 2ï¸âƒ£ CascadeType.MERGE
- ë¶€ëª¨ ì—”í‹°í‹°ê°€ **ë³‘í•©ë  ë•Œ**, ì—°ê´€ëœ ìì‹ ì—”í‹°í‹°ë„ í•¨ê»˜ ë³‘í•©ë©ë‹ˆë‹¤.
    - ì¦‰, EntityManager.merge() í˜¸ì¶œ ì‹œ ìì‹ ì—”í‹°í‹°ë„ ìë™ìœ¼ë¡œ mergeë©ë‹ˆë‹¤.

### 3ï¸âƒ£ CascadeType.REMOVE
- ë¶€ëª¨ ì—”í‹°í‹°ê°€ **ì‚­ì œë  ë•Œ**, ì—°ê´€ëœ ìì‹ ì—”í‹°í‹°ë„ í•¨ê»˜ ì‚­ì œë©ë‹ˆë‹¤.
    - EntityManager.remove() í˜¸ì¶œ ì‹œ ìì‹ ì—”í‹°í‹°ë„ ìë™ìœ¼ë¡œ removeë©ë‹ˆë‹¤.

### 4ï¸âƒ£ CascadeType.REFRESH
- ë¶€ëª¨ ì—”í‹°í‹°ê°€ **ìƒˆë¡œ ê³ ì¹¨ë  ë•Œ**, ì—°ê´€ëœ ìì‹ ì—”í‹°í‹°ë„ í•¨ê»˜ ìƒˆë¡œ ê³ ì¹¨ë©ë‹ˆë‹¤.
    - EntityManager.refresh() í˜¸ì¶œ ì‹œ ìì‹ ì—”í‹°í‹°ë„ refreshë©ë‹ˆë‹¤.

### 5ï¸âƒ£ CascadeType.DETACH
- ë¶€ëª¨ ì—”í‹°í‹°ê°€ **ì¤€ì˜ì† ìƒíƒœë¡œ ë³€ê²½ë  ë•Œ**, ì—°ê´€ëœ ìì‹ ì—”í‹°í‹°ë„ í•¨ê»˜ ì¤€ì˜ì† ìƒíƒœë¡œ ë³€ê²½ë©ë‹ˆë‹¤.
    - EntityManager.detach() í˜¸ì¶œ ì‹œ ìì‹ ì—”í‹°í‹°ë„ ìë™ìœ¼ë¡œ detachë©ë‹ˆë‹¤.

### 6ï¸âƒ£ CascadeType.ALL
- ìœ„ì˜ ëª¨ë“  ì˜µì…˜ì„ ì ìš©í•˜ì—¬, ëª¨ë“  ì‘ì—…(persist, merge, remove, refresh, detach)ì´ ìì‹ ì—”í‹°í‹°ì— ì „íŒŒë˜ë„ë¡ í•©ë‹ˆë‹¤.

## 2ï¸âƒ£ ì˜ˆì œ: CascadeType.PERSISTì™€ CascadeType.REMOVE ì‚¬ìš©.
- ë‹¤ìŒ ì˜ˆì œì—ì„œëŠ” CascadeType.PERSISTì™€ CascadeType.REMOVEë¥¼ ì‚¬ìš©í•˜ì—¬ ë¶€ëª¨ ì—”í‹°í‹° Orderê°€ ì €ì¥ ë° ì‚­ì œë  ë•Œ, ì—°ê´€ëœ ìì‹ ì—”í‹°í‹° OrderItemë„ í•¨ê»˜ ì €ì¥ ë° ì‚­ì œë˜ëŠ” ìƒí™©ì„ ë³´ì—¬ì¤ë‹ˆë‹¤.

```java
@Entity
public class Order {
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;
    
    private String customerName;
    
    @OneToMany(mappedBy = "order", cascade = {CascadeType.PERSIST, Cascade.REMOVE})
    private List<OrderItem> orderItems = new ArrayList<>();
    
    // ì—°ê´€ê´€ê³„ í¸ì˜ ë©”ì„œë“œ
    public void addOrderItem(OrderItem item) {
        orderItems.add(item);
        item.setOrder(this);
    }
    
    // getter, setter
}

@Entity
public class OrderItem {
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;
    
    private String productName;
    private int quantity;
    
    @ManyToOne
    @JoinColumn(name = "order_id")
    private Order order;
    
    // getter, setter
}
```

### ğŸ‘‰ ì½”ë“œ ì„¤ëª….
- Order ì—”í‹°í‹°ì—ì„œ orderItems í•„ë“œëŠ” `@OneToMany` ê´€ê³„ë¡œ ì„¤ì •ë˜ì–´ ìˆìœ¼ë©°, casecade = {CascadeType.PERSIST, CascadeType.REMOVE} ì˜µì…˜ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.
- Order ì—”í‹°í‹°ê°€ persistë  ë•Œ OrderItem ì—”í‹°í‹°ë„ í•¨ê»˜ ì €ì¥ë˜ê³ , Order ì—”í‹°í‹°ê°€ ì‚­ì œë  ë•Œ OrderItem ì—”í‹°í‹°ë„ í•¨ê»˜ ì‚­ì œë©ë‹ˆë‹¤.

## 3ï¸âƒ£ ì˜ˆì œ ì½”ë“œ ì‹¤í–‰.
```java
Order order = new Order();
order.setCustomerName("Alice");

OrderItem item1 = new OrderItem();
item1.setProductName("Laptop");
item1.setQuantity(1);

OrderItem item2 = new OrderItem();
item2.setProductName("Mouse");
item2.setQuantity(2);

order.addOrderItem(item1);
order.addOrderItem(item2);

entityManager.persist(order); // Orderì™€ OrderItemë“¤ì´ í•¨ê»˜ ì €ì¥ë¨
```
- ìœ„ ì½”ë“œì—ì„œ entityManager.persist(order)ë¥¼ í˜¸ì¶œí•˜ë©´ Orderì™€ ì—°ê´€ëœ OrderItem ì—”í‹°í‹°ë“¤ì´ **í•¨ê»˜ ì €ì¥**ë©ë‹ˆë‹¤.
    - ì´í›„ entityManager.remove(order)ë¥¼ í˜¸ì¶œí•˜ë©´ Orderì™€ OrderItem ì—”í‹°í‹°ë“¤ì´ **í•¨ê»˜ ì‚­ì œ**ë©ë‹ˆë‹¤.

## 4ï¸âƒ£ Cascade ì˜µì…˜ ì‚¬ìš© ì‹œ ì£¼ì˜ ì‚¬í•­.
- **CascadeType.REMOVE**ëŠ” ë¶€ëª¨ ì—”í‹°í‹°ê°€ ì‚­ì œë  ë•Œ ìì‹ ì—”í‹°í‹°ë„ ì‚­ì œë˜ë¯€ë¡œ, ë¶ˆí•„ìš”í•œ ë°ì´í„° ì‚­ã…ˆë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•´ ì‹ ì¤‘í•˜ê²Œ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤.
- **ì—°ê´€ê´€ê³„ê°€ ë³µì¡**í•  ê²½ìš° CascadeType.ALLì„ ì‚¬ìš©í•˜ë©´ ì˜ë„ì¹˜ ì•Šì€ ì—°ì‡„ì  ì‘ì—…ì´ ë°œìƒí•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ, ê¼­ í•„ìš”í•œ ì˜µì…˜ë§Œ ì„ íƒì ìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.
- **ì–‘ë°©í–¥ ì—°ê´€ê´€ê³„**ì—ì„œ ìˆœí™˜ ì°¸ì¡° ë¬¸ì œê°€ ë°œìƒí•˜ì§€ ì•Šë„ë¡ ì£¼ì˜ê°€ í•„ìš”í•©ë‹ˆë‹¤.

## 5ï¸âƒ£ ìš”ì•½.
- **Cascade ì˜µì…˜**ì€ ë¶€ëª¨ ì—”í‹°í‹°ì— ìˆ˜í–‰ëœ ì‘ì—…ì´ ìì‹ ì—”í‹°í‹°ì— ìë™ìœ¼ë¡œ ì „íŒŒë˜ë„ë¡ ì„¤ì •í•˜ëŠ” ê¸°ëŠ¥ì…ë‹ˆë‹¤.
- ê° ì˜µì…˜(PRESIST, MERGE, REMOVE, REFRESH, DETACH, ALL)ì€ íŠ¹ì • ì‘ì—…ì— ëŒ€í•œ ì „íŒŒ ë°©ì‹ì„ ì •ì˜í•©ë‹ˆë‹¤.
- Cascade ì˜µì…˜ì€ ë°ì´í„° ì¼ê´€ì„± ìœ ì§€ì— ë„ì›€ì´ ë˜ì§€ë§Œ, ë¶ˆí•„ìš”í•œ ì „íŒŒë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•´ ì‹ ì¤‘í•˜ê²Œ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤.
