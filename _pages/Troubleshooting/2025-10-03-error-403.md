---
title: "🔍[Troubleshooting] 🚀 403 에러 해결"
tags:
    - Troubleshooting
    - Backend Development
    - Spring Boot
date: "2025-10-03"
thumbnail: "/assets/img/thumbnail/troubleshooting.jpg"
---

# 🚀 403 에러 해결!

## 🔍 핵심 원인

**GET 요청에서 `@RequestBody`를 사용하려고 했기 때문입니다.**

---

## 📋 문제 상황

### 기존 코드
```java
@GetMapping
public ResponseEntity<StudentResponseDto> getStudent(
    @RequestBody String studentId  // ❌ GET 요청에 @RequestBody 사용
) {
    return ResponseEntity.ok(studentService.getStudent(studentId));
}
```

### 발생한 에러
```
java.lang.IllegalArgumentException: 존재하지 않는 학생입니다.
```
- 최종 응답: **403 Forbidden**
- 예외 발생 위치: `StudentService` 56번째 줄

---

## 💡 원인 분석

### 1. HTTP GET 요청의 특성
- GET 요청은 리소스 조회를 위해 사용
- Body를 포함할 수 있지만, **대부분의 서버가 이를 무시하도록 설계됨**
- HTTP/1.1 명세에서도 GET의 Body 처리를 권장하지 않음

### 2. Spring Boot의 동작
```
요청 흐름:
Postman GET 요청 (Body: {"studentId": "1003001"})
    ↓
Spring MVC가 @RequestBody로 바인딩 시도
    ↓
바인딩 실패 → studentId에 null 전달
    ↓
studentRepository.findByStudentId(null)
    ↓
Optional.empty() → orElseThrow() 호출
    ↓
IllegalArgumentException 발생
    ↓
Spring Security의 ExceptionTranslationFilter 처리
    ↓
403 Forbidden 응답
```

### 3. 주요 포인트
- `SecurityConfig`에서 `permitAll()` 설정과 무관하게 발생
- 보안 문제가 아닌 **요청 처리 과정의 문제**
- `null` 값으로 인한 비즈니스 로직 예외가 근본 원인

---

## ✅ 해결 방안

### 1. Controller 수정

**Before**
```java
@GetMapping
public ResponseEntity<StudentResponseDto> getStudent(
    @RequestBody String studentId
) {
    return ResponseEntity.ok(studentService.getStudent(studentId));
}
```

**After**
```java
@GetMapping("/{studentId}")
public ResponseEntity<StudentResponseDto> getStudent(
    @PathVariable String studentId  // ✅ URL 경로에서 값 추출
) {
    return ResponseEntity.ok(studentService.getStudent(studentId));
}
```

### 2. 변경 사항
| 항목 | 변경 전 | 변경 후 |
|------|---------|---------|
| 매핑 경로 | `@GetMapping` | `@GetMapping("/{studentId}")` |
| 파라미터 어노테이션 | `@RequestBody` | `@PathVariable` |
| 데이터 위치 | Request Body | URL Path |

---

## 🧪 테스트 방법

### Postman 설정
```
Method: GET
URL: http://localhost:8080/api/v1/management/1003001
       └─────────────────────────────────────┬─────┘
                                        studentId 값
Body: None
```

### 예상 결과
```json
{
  "studentId": "1003001",
  "name": "홍길동",
  ...
}
```

---

## 📌 참고: GET 요청 파라미터 전달 방식

| 방식 | 어노테이션 | 사용 예시 | 적합한 상황 |
|------|-----------|----------|------------|
| **Path Variable** | `@PathVariable` | `/students/{id}` | 리소스 식별 (권장) |
| **Query Parameter** | `@RequestParam` | `/students?id=1003001` | 필터링, 검색 조건 |
| ~~Request Body~~ | ~~`@RequestBody`~~ | ❌ GET에서 비권장 | POST, PUT 등에서 사용 |

### 💡 Best Practice
- **단일 리소스 조회**: `@PathVariable` 사용
- **목록 조회 + 필터**: `@RequestParam` 사용
- **복잡한 데이터 전송**: POST/PUT 메서드 + `@RequestBody` 사용

