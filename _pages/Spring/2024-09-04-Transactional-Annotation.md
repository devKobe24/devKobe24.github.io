---
title: πƒ[Spring] `@Transactional` μ• λ…Έν…μ΄μ…
tags:
    - Spring
    - Framework
date: "2024-09-04"
thumbnail: "/assets/img/thumbnail/spring.jpeg"
---

# πƒ[Spring] `@Transactional` μ• λ…Έν…μ΄μ….
- `@Transactional` μ• λ…Έν…μ΄μ…μ€ Spring Frameworkμ—μ„ μ κ³µν•λ” μ• λ…Έν…μ΄μ…μΌλ΅, λ©”μ„λ“λ‚ ν΄λμ¤μ— μ μ©ν•μ—¬ ν•΄λ‹Ή λ²”μ„ λ‚΄μ λ°μ΄ν„°λ² μ΄μ¤ μ‘μ—…μ„ ν•λ‚μ νΈλμ­μ…μΌλ΅ κ΄€λ¦¬ν•  μ μλ„λ΅ ν•΄μ¤λ‹λ‹¤.
    - μ¦‰, `@Transactional`μ„ μ‚¬μ©ν•λ©΄ μ§€μ •λ λ©”μ„λ“ λλ” ν΄λμ¤ λ‚΄μ λ°μ΄ν„°λ² μ΄μ¤ μ‘μ—…μ΄ λ¨λ‘ μ„±κ³µν•΄μ•Όλ§ μ»¤λ°‹(commit)λκ³ , κ·Έλ ‡μ§€ μ•μΌλ©΄ λ΅¤λ°±(rollback)λ©λ‹λ‹¤.

## 1οΈβƒ£ μ£Όμ” κΈ°λ¥.
- **1. νΈλμ­μ… κ΄€λ¦¬.**
    - `@Transactional` μ• λ…Έν…μ΄μ…μ΄ μ μ©λ λ©”μ„λ“ λ‚΄μ—μ„ μν–‰λλ” λ¨λ“  λ°μ΄ν„°λ² μ΄μ¤ μ‘μ—…(μ: INSERT, UPDATE, DELETE)μ€ ν•λ‚μ νΈλμ­μ…μΌλ΅ κ΄€λ¦¬λ©λ‹λ‹¤.
        - λ§μ•½ λ©”μ„λ“ μ‹¤ν–‰ μ¤‘ μμ™Έκ°€ λ°μƒν•λ©΄, ν•΄λ‹Ή νΈλμ­μ… λ‚΄μ λ¨λ“  λ³€κ²½ μ‚¬ν•­μ΄ λ΅¤λ°±λ©λ‹λ‹¤.
- **2. μ μ© λ²”μ„.**
    - `@Transactional`μ€ ν΄λμ¤λ‚ λ©”μ„λ“μ— μ μ©ν•  μ μμµλ‹λ‹¤.
    - ν΄λμ¤μ— μ μ©ν•λ©΄ ν•΄λ‹Ή ν΄λμ¤μ λ¨λ“  λ©”μ„λ“κ°€ νΈλμ­μ… λ‚΄μ—μ„ μ‹¤ν–‰λ©λ‹λ‹¤.
    - λ©”μ¤νΈμ— μ μ©λλ©΄ ν•΄λ‹Ή λ©”μ„λ“λ§ νΈλμ­μ…μΌλ΅ κ΄€λ¦¬λ©λ‹λ‹¤.
- **3. νΈλμ­μ… μ „ν(Propagation)**
    - `@Transactional`μ€ μ—¬λ¬ μ „ν(Propagation) μµμ…μ„ μ κ³µν•μ—¬ νΈλμ­μ…μ΄ λ‹¤λ¥Έ νΈλμ­μ…κ³Ό μ–΄λ–»κ² μƒνΈμ‘μ©ν• μ§€λ¥Ό μ •μν•  μ μμµλ‹λ‹¤.
        - `REQUIRED` : κΈ°λ³Έκ°’μΌλ΅, ν„μ¬ νΈλμ­μ…μ΄ μ΅΄μ¬ν•λ©΄ μ΄λ¥Ό μ‚¬μ©ν•κ³ , μ—†μΌλ©΄ μƒλ΅μ΄ νΈλμ­μ…μ„ μƒμ„±ν•©λ‹λ‹¤.
        - `REQUIRES_NEW` : ν•­μƒ μƒλ΅μ΄ νΈλμ­μ…μ„ μƒμ„±ν•κ³ , κΈ°μ΅΄ νΈλμ­μ…μ„ μΌμ‹ μ •μ§€ν•©λ‹λ‹¤.
        - `MANDATORY` : ν„μ¬ νΈλμ­μ…μ΄ λ°λ“μ‹ μ΅΄μ¬ν•΄μ•Ό ν•λ©°, μ—†μΌλ©΄ μμ™Έκ°€ λ°μƒν•©λ‹λ‹¤.
        - `SUPPORT` : ν„μ¬ νΈλμ­μ…μ΄ μμΌλ©΄ μ΄λ¥Ό μ‚¬μ©ν•κ³ , μ—†μΌλ©΄ νΈλμ­μ… μ—†μ΄ μ‹¤ν–‰ν•©λ‹λ‹¤.
        - κΈ°νƒ€ : `NOT_SUPPORT`, `NEVER`, `NESTED` λ“±.
- **4. νΈλμ­μ… κ²©λ¦¬ μμ¤€(Isolation Level)**
    - λ°μ΄ν„°λ² μ΄μ¤ νΈλμ­μ…μ κ²©λ¦¬ μμ¤€μ„ μ„¤μ •ν•  μ μμµλ‹λ‹¤.
        - μ΄λ” λ™μ‹μ— μ‹¤ν–‰λλ” μ—¬λ¬ νΈλμ­μ… κ°„μ μƒνΈμ‘μ© λ°©μ‹μ„ μ •μν•©λ‹λ‹¤.
            - `READ_UNCOMMITTED` : λ‹¤λ¥Έ νΈλμ­μ…μ λ―Έμ™„λ£ λ³€κ²½ μ‚¬ν•­μ„ μ½μ„ μ μμµλ‹λ‹¤.
            - `READ_COMMITED` : λ‹¤λ¥Έ νΈλμ­μ…μ μ»¤λ°‹λ λ³€κ²½ μ‚¬ν•­λ§ μ½μ„ μ μμµλ‹λ‹¤.
            - `REPEATABLE_READ` : νΈλμ­μ… λ™μ• λ™μΌν• λ°μ΄ν„°λ¥Ό λ°λ³µμ μΌλ΅ μ½μ–΄λ„ λ™μΌν• κ²°κ³Όλ¥Ό λ³΄μ¥ν•©λ‹λ‹¤.
            - `SERIALIZABLE` : κ°€μ¥ μ—„κ²©ν• κ²©λ¦¬ μμ¤€μΌλ΅, νΈλμ­μ…μ΄ μ™„μ „ν μμ°¨μ μΌλ΅ μ‹¤ν–‰λλ„λ΅ λ³΄μ¥ν•©λ‹λ‹¤.
- **5. λ΅¤λ°± κ·μΉ™(Rollback Rules)**
    - κΈ°λ³Έμ μΌλ΅ `@Transactional` μ€ `RuntimeException` λλ” `Error` κ°€ λ°μƒν•λ©΄ νΈλμ­μ…μ„ λ΅¤λ°±ν•©λ‹λ‹¤.
        - νΉμ • μμ™Έμ— λ€ν•΄ λ΅¤λ°±μ„ κ°•μ ν•κ±°λ‚, λ΅¤λ°±μ„ λ°©μ§€ν•λ„λ΅ μ„¤μ •ν•  μ μμµλ‹λ‹¤.
    - `rollbackFor` λλ” `noRollbackFor` μ†μ„±μ„ μ‚¬μ©ν•μ—¬ μ΄ λ™μ‘μ„ μ»¤μ¤ν„°λ§μ΄μ§•ν•  μ μμµλ‹λ‹¤.
- **6. μ½κΈ° μ „μ©(Read-Only)**
    - `@Transactional(readOnly = true)`λ΅ μ„¤μ •ν•λ©΄ νΈλμ­μ…μ΄ λ°μ΄ν„° μ½κΈ° μ „μ©μΌλ΅ λ™μ‘ν•λ©°, μ΄ κ²½μ° λ°μ΄ν„° μμ • μ‘μ—…μ΄ μµμ ν™”λ  μ μμµλ‹λ‹¤.
        - μ£Όλ΅ SELECT μΏΌλ¦¬μ—μ„ μ‚¬μ©λ©λ‹λ‹¤.
## 2οΈβƒ£ μμ‹ μ½”λ“

```java
@Service
public class MyService {
    
    @Autowired
    private MyRepository myRepository;
    
    @Transactional
    public void performTransaction() {
        // λ°μ΄ν„°λ² μ΄μ¤μ— μƒλ΅μ΄ μ—”ν‹°ν‹° μ¶”κ°€
        myRepository.save(new MyEntity("Data1"));
        
        // λ‹¤λ¥Έ λ°μ΄ν„°λ² μ΄μ¤ μ‘μ—… μν–‰
        myRepository.updateEntity(1L, "UpdatedData");
        
        // μμ™Έ λ°μƒ μ‹, μ„μ λ¨λ“  μ‘μ—…μ΄ λ΅¤λ°±λ¨
        if (someConditionFails()) {
            throw new RuntimeException("Transaction failed, rolling back...");
        }
    }
    
    @Transactional(readOnly = true)
    public List<MyEntity> getEntities() {
        return myRepository.findAll();
    }
}
```

## 3οΈβƒ£ μ”μ•½.
- **`@Transactional`** μ€ λ°μ΄ν„°λ² μ΄μ¤ νΈλμ­μ…μ„ μ‰½κ² κ΄€λ¦¬ν•  μ μλ„λ΅ ν•΄μ£Όλ” Springμ ν•µμ‹¬ μ• λ…Έν…μ΄μ…μ…λ‹λ‹¤.
    - μ΄ μ• λ…Έν…μ΄μ…μ„ μ‚¬μ©ν•λ©΄ λ©”μ„λ“λ‚ ν΄λμ¤μ λ°μ΄ν„°λ² μ΄μ¤ μ‘μ—…μ„ ν•λ‚μ νΈλμ­μ…μΌλ΅ μ²λ¦¬ν•λ©°, μ‹¤ν¨ μ‹ μλ™μΌλ΅ λ΅¤λ°±λ©λ‹λ‹¤.
        - λν•, νΈλμ­μ… μ „ν, κ²©λ¦¬ μμ¤€, λ΅¤λ°± κ·μΉ™ λ“±μ„ ν†µν•΄ μ„Έλ¶€μ μΌλ΅ νΈλμ­μ…μ λ™μ‘μ„ μ μ–΄ν•  μ μμµλ‹λ‹¤.

μ΄λ¬ν• κΈ°λ¥ λ•λ¶„μ— `@Transactional`μ€ Spring μ• ν”λ¦¬μΌ€μ΄μ…μ—μ„ λ°μ΄ν„° μΌκ΄€μ„±κ³Ό λ¬΄κ²°μ„±μ„ μ μ§€ν•λ” λ° μ¤‘μ”ν• μ—­ν• μ„ ν•©λ‹λ‹¤.
